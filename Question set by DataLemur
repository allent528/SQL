/* An assortment of questions by DataLemur of the medium and hard difficulty. 
I'll leave it to you to decide which ones are medium and which ones are hard */

/* Source: https://datalemur.com/questions */


-- 1. User's Third Transaction
-- Assume you are given the table below on Uber transactions made by users. Write a query to obtain the third transaction of every user. 
-- Output the user id, spend and transaction date.

WITH table_table AS (
select user_id, spend, transaction_date,
row_number() OVER (partition by user_id order by transaction_date) as third3
from transactions
)

select user_id, spend, transaction_date
from table_table
where third3 = 3
;
